{'batch_size': 4, 'sequence_file': 'preprocessed_train_sequences.npz', 'data_file': 'train_data.npz', 'edge_file': 'train_edge_lists.npz', 'max_len': 1200, 'vocab_size': 22, 'embed_dim': 256, 'num_heads': 16, 'num_layers': 1, 'num_gnn_layers': 3, 'num_classes': 8, 'num_epochs': 1000, 'learning_rate': 0.0001, 'max_grad_norm': 0.1, 'validation_split': 0.1, 'early_stop_patience': 10, 'initial_gradient_noise_std': 0.05, 'accumulation_steps': 2}
Number of GPUs available: 4
Initializing ClassificationModel with 3 GAT layers and residual connections...
Initializing CGModel with 3 GAT layers and residual connections...
Initializing CoreModel with 1 self-attention layers...
Using 4 GPUs with DataParallel.
Epoch [1/1000], Training Loss: 1.1094, Gradient Noise Std: 0.050000
Validation Loss: 0.9742
New best model found with validation loss: 0.9742
Epoch [2/1000], Training Loss: 0.9221, Gradient Noise Std: 0.045000
Validation Loss: 0.9057
New best model found with validation loss: 0.9057
Epoch [3/1000], Training Loss: 0.8676, Gradient Noise Std: 0.040500
Validation Loss: 0.8672
New best model found with validation loss: 0.8672
Epoch [4/1000], Training Loss: 0.8301, Gradient Noise Std: 0.036450
Validation Loss: 0.8369
New best model found with validation loss: 0.8369
Epoch [5/1000], Training Loss: 0.8036, Gradient Noise Std: 0.032805
Validation Loss: 0.8222
New best model found with validation loss: 0.8222
Epoch [6/1000], Training Loss: 0.7809, Gradient Noise Std: 0.029525
Validation Loss: 0.7960
New best model found with validation loss: 0.7960
Epoch [7/1000], Training Loss: 0.7637, Gradient Noise Std: 0.026572
Validation Loss: 0.7767
New best model found with validation loss: 0.7767
Epoch [8/1000], Training Loss: 0.7484, Gradient Noise Std: 0.023915
Validation Loss: 0.7681
New best model found with validation loss: 0.7681
Epoch [9/1000], Training Loss: 0.7368, Gradient Noise Std: 0.021523
Validation Loss: 0.7599
New best model found with validation loss: 0.7599
Epoch [10/1000], Training Loss: 0.7275, Gradient Noise Std: 0.019371
Validation Loss: 0.7573
New best model found with validation loss: 0.7573
Epoch [11/1000], Training Loss: 0.7093, Gradient Noise Std: 0.017434
Validation Loss: 0.7401
New best model found with validation loss: 0.7401
Epoch [12/1000], Training Loss: 0.7019, Gradient Noise Std: 0.015691
Validation Loss: 0.7322
New best model found with validation loss: 0.7322
Epoch [13/1000], Training Loss: 0.6958, Gradient Noise Std: 0.014121
Validation Loss: 0.7258
New best model found with validation loss: 0.7258
Epoch [14/1000], Training Loss: 0.6927, Gradient Noise Std: 0.012709
Validation Loss: 0.7175
New best model found with validation loss: 0.7175
Epoch [15/1000], Training Loss: 0.6889, Gradient Noise Std: 0.011438
Validation Loss: 0.7192
No improvement in validation loss. Early stop counter: 1/10
Epoch [16/1000], Training Loss: 0.6828, Gradient Noise Std: 0.010295
Validation Loss: 0.7211
No improvement in validation loss. Early stop counter: 2/10
Epoch [17/1000], Training Loss: 0.6789, Gradient Noise Std: 0.009265
Validation Loss: 0.7131
New best model found with validation loss: 0.7131
Epoch [18/1000], Training Loss: 0.6757, Gradient Noise Std: 0.008339
Validation Loss: 0.7093
New best model found with validation loss: 0.7093
Epoch [19/1000], Training Loss: 0.6737, Gradient Noise Std: 0.007505
Validation Loss: 0.7112
No improvement in validation loss. Early stop counter: 1/10
Epoch [20/1000], Training Loss: 0.6710, Gradient Noise Std: 0.006754
Validation Loss: 0.6987
New best model found with validation loss: 0.6987
Epoch [21/1000], Training Loss: 0.6609, Gradient Noise Std: 0.006079
Validation Loss: 0.6955
New best model found with validation loss: 0.6955
Epoch [22/1000], Training Loss: 0.6583, Gradient Noise Std: 0.005471
Validation Loss: 0.6910
New best model found with validation loss: 0.6910
Epoch [23/1000], Training Loss: 0.6570, Gradient Noise Std: 0.004924
Validation Loss: 0.6887
New best model found with validation loss: 0.6887
Epoch [24/1000], Training Loss: 0.6547, Gradient Noise Std: 0.004431
Validation Loss: 0.6879
New best model found with validation loss: 0.6879
Epoch [25/1000], Training Loss: 0.6535, Gradient Noise Std: 0.003988
Validation Loss: 0.6897
No improvement in validation loss. Early stop counter: 1/10
Epoch [26/1000], Training Loss: 0.6521, Gradient Noise Std: 0.003589
Validation Loss: 0.6864
New best model found with validation loss: 0.6864
Epoch [27/1000], Training Loss: 0.6493, Gradient Noise Std: 0.003231
Validation Loss: 0.6859
New best model found with validation loss: 0.6859
Epoch [28/1000], Training Loss: 0.6476, Gradient Noise Std: 0.002907
Validation Loss: 0.6838
New best model found with validation loss: 0.6838
Epoch [29/1000], Training Loss: 0.6459, Gradient Noise Std: 0.002617
Validation Loss: 0.6860
No improvement in validation loss. Early stop counter: 1/10
Epoch [30/1000], Training Loss: 0.6452, Gradient Noise Std: 0.002355
Validation Loss: 0.6788
New best model found with validation loss: 0.6788
Epoch [31/1000], Training Loss: 0.6391, Gradient Noise Std: 0.002120
Validation Loss: 0.6778
New best model found with validation loss: 0.6778
Epoch [32/1000], Training Loss: 0.6394, Gradient Noise Std: 0.001908
Validation Loss: 0.6782
No improvement in validation loss. Early stop counter: 1/10
Epoch [33/1000], Training Loss: 0.6391, Gradient Noise Std: 0.001717
Validation Loss: 0.6747
New best model found with validation loss: 0.6747
Epoch [34/1000], Training Loss: 0.6371, Gradient Noise Std: 0.001545
Validation Loss: 0.6746
New best model found with validation loss: 0.6746
Epoch [35/1000], Training Loss: 0.6360, Gradient Noise Std: 0.001391
Validation Loss: 0.6737
New best model found with validation loss: 0.6737
Epoch [36/1000], Training Loss: 0.6355, Gradient Noise Std: 0.001252
Validation Loss: 0.6733
New best model found with validation loss: 0.6733
Epoch [37/1000], Training Loss: 0.6343, Gradient Noise Std: 0.001126
Validation Loss: 0.6721
New best model found with validation loss: 0.6721
Epoch [38/1000], Training Loss: 0.6342, Gradient Noise Std: 0.001014
Validation Loss: 0.6727
No improvement in validation loss. Early stop counter: 1/10
Epoch [39/1000], Training Loss: 0.6332, Gradient Noise Std: 0.000912
Validation Loss: 0.6732
No improvement in validation loss. Early stop counter: 2/10
Epoch [40/1000], Training Loss: 0.6326, Gradient Noise Std: 0.000821
Validation Loss: 0.6709
New best model found with validation loss: 0.6709
Epoch [41/1000], Training Loss: 0.6295, Gradient Noise Std: 0.000739
Validation Loss: 0.6693
New best model found with validation loss: 0.6693
Epoch [42/1000], Training Loss: 0.6298, Gradient Noise Std: 0.000665
Validation Loss: 0.6683
New best model found with validation loss: 0.6683
Epoch [43/1000], Training Loss: 0.6289, Gradient Noise Std: 0.000599
Validation Loss: 0.6672
New best model found with validation loss: 0.6672
Epoch [44/1000], Training Loss: 0.6269, Gradient Noise Std: 0.000539
Validation Loss: 0.6686
No improvement in validation loss. Early stop counter: 1/10
Epoch [45/1000], Training Loss: 0.6275, Gradient Noise Std: 0.000485
Validation Loss: 0.6666
New best model found with validation loss: 0.6666
Epoch [46/1000], Training Loss: 0.6286, Gradient Noise Std: 0.000436
Validation Loss: 0.6669
No improvement in validation loss. Early stop counter: 1/10
Epoch [47/1000], Training Loss: 0.6266, Gradient Noise Std: 0.000393
Validation Loss: 0.6647
New best model found with validation loss: 0.6647
Epoch [48/1000], Training Loss: 0.6258, Gradient Noise Std: 0.000353
Validation Loss: 0.6657
No improvement in validation loss. Early stop counter: 1/10
Epoch [49/1000], Training Loss: 0.6249, Gradient Noise Std: 0.000318
Validation Loss: 0.6656
No improvement in validation loss. Early stop counter: 2/10
Epoch [50/1000], Training Loss: 0.6262, Gradient Noise Std: 0.000286
Validation Loss: 0.6654
No improvement in validation loss. Early stop counter: 3/10
Epoch [51/1000], Training Loss: 0.6234, Gradient Noise Std: 0.000258
Validation Loss: 0.6647
New best model found with validation loss: 0.6647
Epoch [52/1000], Training Loss: 0.6246, Gradient Noise Std: 0.000232
Validation Loss: 0.6632
New best model found with validation loss: 0.6632
Epoch [53/1000], Training Loss: 0.6256, Gradient Noise Std: 0.000209
Validation Loss: 0.6635
No improvement in validation loss. Early stop counter: 1/10
Epoch [54/1000], Training Loss: 0.6251, Gradient Noise Std: 0.000188
Validation Loss: 0.6636
No improvement in validation loss. Early stop counter: 2/10
Epoch [55/1000], Training Loss: 0.6237, Gradient Noise Std: 0.000169
Validation Loss: 0.6639
No improvement in validation loss. Early stop counter: 3/10
Epoch [56/1000], Training Loss: 0.6228, Gradient Noise Std: 0.000152
Validation Loss: 0.6641
No improvement in validation loss. Early stop counter: 4/10
Epoch [57/1000], Training Loss: 0.6234, Gradient Noise Std: 0.000137
Validation Loss: 0.6627
New best model found with validation loss: 0.6627
Epoch [58/1000], Training Loss: 0.6225, Gradient Noise Std: 0.000123
Validation Loss: 0.6638
No improvement in validation loss. Early stop counter: 1/10
Epoch [59/1000], Training Loss: 0.6223, Gradient Noise Std: 0.000111
Validation Loss: 0.6624
New best model found with validation loss: 0.6624
Epoch [60/1000], Training Loss: 0.6208, Gradient Noise Std: 0.000100
Validation Loss: 0.6631
No improvement in validation loss. Early stop counter: 1/10
Epoch [61/1000], Training Loss: 0.6217, Gradient Noise Std: 0.000090
Validation Loss: 0.6619
New best model found with validation loss: 0.6619
Epoch [62/1000], Training Loss: 0.6211, Gradient Noise Std: 0.000081
Validation Loss: 0.6614
New best model found with validation loss: 0.6614
Epoch [63/1000], Training Loss: 0.6208, Gradient Noise Std: 0.000073
Validation Loss: 0.6618
No improvement in validation loss. Early stop counter: 1/10
Epoch [64/1000], Training Loss: 0.6216, Gradient Noise Std: 0.000066
Validation Loss: 0.6616
No improvement in validation loss. Early stop counter: 2/10
Epoch [65/1000], Training Loss: 0.6210, Gradient Noise Std: 0.000059
Validation Loss: 0.6613
New best model found with validation loss: 0.6613
Epoch [66/1000], Training Loss: 0.6203, Gradient Noise Std: 0.000053
Validation Loss: 0.6611
New best model found with validation loss: 0.6611
Epoch [67/1000], Training Loss: 0.6218, Gradient Noise Std: 0.000048
Validation Loss: 0.6615
No improvement in validation loss. Early stop counter: 1/10
Epoch [68/1000], Training Loss: 0.6212, Gradient Noise Std: 0.000043
Validation Loss: 0.6610
New best model found with validation loss: 0.6610
Epoch [69/1000], Training Loss: 0.6210, Gradient Noise Std: 0.000039
Validation Loss: 0.6613
No improvement in validation loss. Early stop counter: 1/10
Epoch [70/1000], Training Loss: 0.6196, Gradient Noise Std: 0.000035
Validation Loss: 0.6608
New best model found with validation loss: 0.6608
Epoch [71/1000], Training Loss: 0.6203, Gradient Noise Std: 0.000031
Validation Loss: 0.6614
No improvement in validation loss. Early stop counter: 1/10
Epoch [72/1000], Training Loss: 0.6205, Gradient Noise Std: 0.000028
Validation Loss: 0.6611
No improvement in validation loss. Early stop counter: 2/10
Epoch [73/1000], Training Loss: 0.6205, Gradient Noise Std: 0.000025
Validation Loss: 0.6610
No improvement in validation loss. Early stop counter: 3/10
Epoch [74/1000], Training Loss: 0.6209, Gradient Noise Std: 0.000023
Validation Loss: 0.6610
No improvement in validation loss. Early stop counter: 4/10
Epoch [75/1000], Training Loss: 0.6204, Gradient Noise Std: 0.000021
Validation Loss: 0.6611
No improvement in validation loss. Early stop counter: 5/10
Epoch [76/1000], Training Loss: 0.6195, Gradient Noise Std: 0.000018
Validation Loss: 0.6608
No improvement in validation loss. Early stop counter: 6/10
Epoch [77/1000], Training Loss: 0.6192, Gradient Noise Std: 0.000017
Validation Loss: 0.6611
No improvement in validation loss. Early stop counter: 7/10
Epoch [78/1000], Training Loss: 0.6195, Gradient Noise Std: 0.000015
Validation Loss: 0.6608
New best model found with validation loss: 0.6608
Epoch [79/1000], Training Loss: 0.6216, Gradient Noise Std: 0.000013
Validation Loss: 0.6604
New best model found with validation loss: 0.6604
Epoch [80/1000], Training Loss: 0.6202, Gradient Noise Std: 0.000012
Validation Loss: 0.6606
No improvement in validation loss. Early stop counter: 1/10
Epoch [81/1000], Training Loss: 0.6199, Gradient Noise Std: 0.000011
Validation Loss: 0.6605
No improvement in validation loss. Early stop counter: 2/10
Epoch [82/1000], Training Loss: 0.6187, Gradient Noise Std: 0.000010
Validation Loss: 0.6604
No improvement in validation loss. Early stop counter: 3/10
Epoch [83/1000], Training Loss: 0.6204, Gradient Noise Std: 0.000009
Validation Loss: 0.6606
No improvement in validation loss. Early stop counter: 4/10
Epoch [84/1000], Training Loss: 0.6196, Gradient Noise Std: 0.000008
Validation Loss: 0.6606
No improvement in validation loss. Early stop counter: 5/10
Epoch [85/1000], Training Loss: 0.6198, Gradient Noise Std: 0.000007
Validation Loss: 0.6605
No improvement in validation loss. Early stop counter: 6/10
Epoch [86/1000], Training Loss: 0.6208, Gradient Noise Std: 0.000006
Validation Loss: 0.6602
New best model found with validation loss: 0.6602
Epoch [87/1000], Training Loss: 0.6196, Gradient Noise Std: 0.000006
Validation Loss: 0.6603
No improvement in validation loss. Early stop counter: 1/10
Epoch [88/1000], Training Loss: 0.6188, Gradient Noise Std: 0.000005
Validation Loss: 0.6601
New best model found with validation loss: 0.6601
Epoch [89/1000], Training Loss: 0.6191, Gradient Noise Std: 0.000005
Validation Loss: 0.6605
No improvement in validation loss. Early stop counter: 1/10
Epoch [90/1000], Training Loss: 0.6186, Gradient Noise Std: 0.000004
Validation Loss: 0.6604
No improvement in validation loss. Early stop counter: 2/10
Epoch [91/1000], Training Loss: 0.6192, Gradient Noise Std: 0.000004
Validation Loss: 0.6603
No improvement in validation loss. Early stop counter: 3/10
Epoch [92/1000], Training Loss: 0.6192, Gradient Noise Std: 0.000003
Validation Loss: 0.6602
No improvement in validation loss. Early stop counter: 4/10
Epoch [93/1000], Training Loss: 0.6189, Gradient Noise Std: 0.000003
Validation Loss: 0.6603
No improvement in validation loss. Early stop counter: 5/10
Epoch [94/1000], Training Loss: 0.6192, Gradient Noise Std: 0.000003
Validation Loss: 0.6603
No improvement in validation loss. Early stop counter: 6/10
Epoch [95/1000], Training Loss: 0.6201, Gradient Noise Std: 0.000002
Validation Loss: 0.6602
No improvement in validation loss. Early stop counter: 7/10
Epoch [96/1000], Training Loss: 0.6194, Gradient Noise Std: 0.000002
Validation Loss: 0.6602
No improvement in validation loss. Early stop counter: 8/10
Epoch [97/1000], Training Loss: 0.6193, Gradient Noise Std: 0.000002
Validation Loss: 0.6602
No improvement in validation loss. Early stop counter: 9/10
Epoch [98/1000], Training Loss: 0.6183, Gradient Noise Std: 0.000002
Validation Loss: 0.6603
No improvement in validation loss. Early stop counter: 10/10
Early stopping triggered after 98 epochs.
Best model saved successfully.
