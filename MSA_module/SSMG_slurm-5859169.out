{'batch_size': 4, 'sequence_file': 'preprocessed_train_sequences.npz', 'data_file': 'train_data.npz', 'edge_file': 'train_edge_lists.npz', 'max_len': 1200, 'vocab_size': 22, 'embed_dim': 256, 'num_heads': 16, 'num_layers': 2, 'num_gnn_layers': 2, 'num_classes': 8, 'num_epochs': 1000, 'learning_rate': 0.0001, 'max_grad_norm': 0.1, 'validation_split': 0.1, 'early_stop_patience': 10, 'initial_gradient_noise_std': 0.05, 'accumulation_steps': 2}
Number of GPUs available: 4
Initializing ClassificationModel with 2 GAT layers and residual connections...
Initializing CGModel with 2 GAT layers and residual connections...
Initializing CoreModel with 2 self-attention layers...
Using 4 GPUs with DataParallel.
Epoch [1/1000], Training Loss: 1.0905, Gradient Noise Std: 0.050000
Validation Loss: 0.9337
New best model found with validation loss: 0.9337
Epoch [2/1000], Training Loss: 0.9023, Gradient Noise Std: 0.045000
Validation Loss: 0.8609
New best model found with validation loss: 0.8609
Epoch [3/1000], Training Loss: 0.8430, Gradient Noise Std: 0.040500
Validation Loss: 0.8063
New best model found with validation loss: 0.8063
Epoch [4/1000], Training Loss: 0.8061, Gradient Noise Std: 0.036450
Validation Loss: 0.7710
New best model found with validation loss: 0.7710
Epoch [5/1000], Training Loss: 0.7818, Gradient Noise Std: 0.032805
Validation Loss: 0.7499
New best model found with validation loss: 0.7499
Epoch [6/1000], Training Loss: 0.7553, Gradient Noise Std: 0.029525
Validation Loss: 0.7203
New best model found with validation loss: 0.7203
Epoch [7/1000], Training Loss: 0.7336, Gradient Noise Std: 0.026572
Validation Loss: 0.6954
New best model found with validation loss: 0.6954
Epoch [8/1000], Training Loss: 0.7203, Gradient Noise Std: 0.023915
Validation Loss: 0.7039
No improvement in validation loss. Early stop counter: 1/10
Epoch [9/1000], Training Loss: 0.7011, Gradient Noise Std: 0.021523
Validation Loss: 0.6713
New best model found with validation loss: 0.6713
Epoch [10/1000], Training Loss: 0.6862, Gradient Noise Std: 0.019371
Validation Loss: 0.6611
New best model found with validation loss: 0.6611
Epoch [11/1000], Training Loss: 0.6657, Gradient Noise Std: 0.017434
Validation Loss: 0.6440
New best model found with validation loss: 0.6440
Epoch [12/1000], Training Loss: 0.6595, Gradient Noise Std: 0.015691
Validation Loss: 0.6366
New best model found with validation loss: 0.6366
Epoch [13/1000], Training Loss: 0.6501, Gradient Noise Std: 0.014121
Validation Loss: 0.6287
New best model found with validation loss: 0.6287
Epoch [14/1000], Training Loss: 0.6457, Gradient Noise Std: 0.012709
Validation Loss: 0.6255
New best model found with validation loss: 0.6255
Epoch [15/1000], Training Loss: 0.6387, Gradient Noise Std: 0.011438
Validation Loss: 0.6202
New best model found with validation loss: 0.6202
Epoch [16/1000], Training Loss: 0.6363, Gradient Noise Std: 0.010295
Validation Loss: 0.6186
New best model found with validation loss: 0.6186
Epoch [17/1000], Training Loss: 0.6294, Gradient Noise Std: 0.009265
Validation Loss: 0.6077
New best model found with validation loss: 0.6077
Epoch [18/1000], Training Loss: 0.6250, Gradient Noise Std: 0.008339
Validation Loss: 0.6108
No improvement in validation loss. Early stop counter: 1/10
Epoch [19/1000], Training Loss: 0.6222, Gradient Noise Std: 0.007505
Validation Loss: 0.6114
No improvement in validation loss. Early stop counter: 2/10
Epoch [20/1000], Training Loss: 0.6151, Gradient Noise Std: 0.006754
Validation Loss: 0.6014
New best model found with validation loss: 0.6014
Epoch [21/1000], Training Loss: 0.6037, Gradient Noise Std: 0.006079
Validation Loss: 0.5944
New best model found with validation loss: 0.5944
Epoch [22/1000], Training Loss: 0.6033, Gradient Noise Std: 0.005471
Validation Loss: 0.5919
New best model found with validation loss: 0.5919
Epoch [23/1000], Training Loss: 0.6002, Gradient Noise Std: 0.004924
Validation Loss: 0.5989
No improvement in validation loss. Early stop counter: 1/10
Epoch [24/1000], Training Loss: 0.5979, Gradient Noise Std: 0.004431
Validation Loss: 0.5888
New best model found with validation loss: 0.5888
Epoch [25/1000], Training Loss: 0.5949, Gradient Noise Std: 0.003988
Validation Loss: 0.5869
New best model found with validation loss: 0.5869
Epoch [26/1000], Training Loss: 0.5926, Gradient Noise Std: 0.003589
Validation Loss: 0.5847
New best model found with validation loss: 0.5847
Epoch [27/1000], Training Loss: 0.5888, Gradient Noise Std: 0.003231
Validation Loss: 0.5825
New best model found with validation loss: 0.5825
Epoch [28/1000], Training Loss: 0.5859, Gradient Noise Std: 0.002907
Validation Loss: 0.5822
New best model found with validation loss: 0.5822
Epoch [29/1000], Training Loss: 0.5858, Gradient Noise Std: 0.002617
Validation Loss: 0.5803
New best model found with validation loss: 0.5803
Epoch [30/1000], Training Loss: 0.5840, Gradient Noise Std: 0.002355
Validation Loss: 0.5864
No improvement in validation loss. Early stop counter: 1/10
Epoch [31/1000], Training Loss: 0.5787, Gradient Noise Std: 0.002120
Validation Loss: 0.5758
New best model found with validation loss: 0.5758
Epoch [32/1000], Training Loss: 0.5765, Gradient Noise Std: 0.001908
Validation Loss: 0.5741
New best model found with validation loss: 0.5741
Epoch [33/1000], Training Loss: 0.5747, Gradient Noise Std: 0.001717
Validation Loss: 0.5746
No improvement in validation loss. Early stop counter: 1/10
Epoch [34/1000], Training Loss: 0.5755, Gradient Noise Std: 0.001545
Validation Loss: 0.5730
New best model found with validation loss: 0.5730
Epoch [35/1000], Training Loss: 0.5743, Gradient Noise Std: 0.001391
Validation Loss: 0.5735
No improvement in validation loss. Early stop counter: 1/10
Epoch [36/1000], Training Loss: 0.5718, Gradient Noise Std: 0.001252
Validation Loss: 0.5722
New best model found with validation loss: 0.5722
Epoch [37/1000], Training Loss: 0.5701, Gradient Noise Std: 0.001126
Validation Loss: 0.5742
No improvement in validation loss. Early stop counter: 1/10
Epoch [38/1000], Training Loss: 0.5694, Gradient Noise Std: 0.001014
Validation Loss: 0.5706
New best model found with validation loss: 0.5706
Epoch [39/1000], Training Loss: 0.5683, Gradient Noise Std: 0.000912
Validation Loss: 0.5725
No improvement in validation loss. Early stop counter: 1/10
Epoch [40/1000], Training Loss: 0.5680, Gradient Noise Std: 0.000821
Validation Loss: 0.5680
New best model found with validation loss: 0.5680
Epoch [41/1000], Training Loss: 0.5640, Gradient Noise Std: 0.000739
Validation Loss: 0.5669
New best model found with validation loss: 0.5669
Epoch [42/1000], Training Loss: 0.5619, Gradient Noise Std: 0.000665
Validation Loss: 0.5677
No improvement in validation loss. Early stop counter: 1/10
Epoch [43/1000], Training Loss: 0.5616, Gradient Noise Std: 0.000599
Validation Loss: 0.5659
New best model found with validation loss: 0.5659
Epoch [44/1000], Training Loss: 0.5601, Gradient Noise Std: 0.000539
Validation Loss: 0.5662
No improvement in validation loss. Early stop counter: 1/10
Epoch [45/1000], Training Loss: 0.5611, Gradient Noise Std: 0.000485
Validation Loss: 0.5686
No improvement in validation loss. Early stop counter: 2/10
Epoch [46/1000], Training Loss: 0.5601, Gradient Noise Std: 0.000436
Validation Loss: 0.5660
No improvement in validation loss. Early stop counter: 3/10
Epoch [47/1000], Training Loss: 0.5600, Gradient Noise Std: 0.000393
Validation Loss: 0.5644
New best model found with validation loss: 0.5644
Epoch [48/1000], Training Loss: 0.5587, Gradient Noise Std: 0.000353
Validation Loss: 0.5654
No improvement in validation loss. Early stop counter: 1/10
Epoch [49/1000], Training Loss: 0.5587, Gradient Noise Std: 0.000318
Validation Loss: 0.5654
No improvement in validation loss. Early stop counter: 2/10
Epoch [50/1000], Training Loss: 0.5598, Gradient Noise Std: 0.000286
Validation Loss: 0.5650
No improvement in validation loss. Early stop counter: 3/10
Epoch [51/1000], Training Loss: 0.5569, Gradient Noise Std: 0.000258
Validation Loss: 0.5631
New best model found with validation loss: 0.5631
Epoch [52/1000], Training Loss: 0.5559, Gradient Noise Std: 0.000232
Validation Loss: 0.5636
No improvement in validation loss. Early stop counter: 1/10
Epoch [53/1000], Training Loss: 0.5541, Gradient Noise Std: 0.000209
Validation Loss: 0.5633
No improvement in validation loss. Early stop counter: 2/10
Epoch [54/1000], Training Loss: 0.5561, Gradient Noise Std: 0.000188
Validation Loss: 0.5631
New best model found with validation loss: 0.5631
Epoch [55/1000], Training Loss: 0.5549, Gradient Noise Std: 0.000169
Validation Loss: 0.5629
New best model found with validation loss: 0.5629
Epoch [56/1000], Training Loss: 0.5540, Gradient Noise Std: 0.000152
Validation Loss: 0.5632
No improvement in validation loss. Early stop counter: 1/10
Epoch [57/1000], Training Loss: 0.5538, Gradient Noise Std: 0.000137
Validation Loss: 0.5622
New best model found with validation loss: 0.5622
Epoch [58/1000], Training Loss: 0.5537, Gradient Noise Std: 0.000123
Validation Loss: 0.5631
No improvement in validation loss. Early stop counter: 1/10
Epoch [59/1000], Training Loss: 0.5550, Gradient Noise Std: 0.000111
Validation Loss: 0.5622
New best model found with validation loss: 0.5622
Epoch [60/1000], Training Loss: 0.5528, Gradient Noise Std: 0.000100
Validation Loss: 0.5615
New best model found with validation loss: 0.5615
Epoch [61/1000], Training Loss: 0.5524, Gradient Noise Std: 0.000090
Validation Loss: 0.5618
No improvement in validation loss. Early stop counter: 1/10
Epoch [62/1000], Training Loss: 0.5520, Gradient Noise Std: 0.000081
Validation Loss: 0.5613
New best model found with validation loss: 0.5613
Epoch [63/1000], Training Loss: 0.5517, Gradient Noise Std: 0.000073
Validation Loss: 0.5618
No improvement in validation loss. Early stop counter: 1/10
Epoch [64/1000], Training Loss: 0.5533, Gradient Noise Std: 0.000066
Validation Loss: 0.5610
New best model found with validation loss: 0.5610
Epoch [65/1000], Training Loss: 0.5523, Gradient Noise Std: 0.000059
Validation Loss: 0.5618
No improvement in validation loss. Early stop counter: 1/10
Epoch [66/1000], Training Loss: 0.5532, Gradient Noise Std: 0.000053
Validation Loss: 0.5610
No improvement in validation loss. Early stop counter: 2/10
Epoch [67/1000], Training Loss: 0.5514, Gradient Noise Std: 0.000048
Validation Loss: 0.5609
New best model found with validation loss: 0.5609
Epoch [68/1000], Training Loss: 0.5516, Gradient Noise Std: 0.000043
Validation Loss: 0.5610
No improvement in validation loss. Early stop counter: 1/10
Epoch [69/1000], Training Loss: 0.5512, Gradient Noise Std: 0.000039
Validation Loss: 0.5613
No improvement in validation loss. Early stop counter: 2/10
Epoch [70/1000], Training Loss: 0.5522, Gradient Noise Std: 0.000035
Validation Loss: 0.5612
No improvement in validation loss. Early stop counter: 3/10
Epoch [71/1000], Training Loss: 0.5510, Gradient Noise Std: 0.000031
Validation Loss: 0.5605
New best model found with validation loss: 0.5605
Epoch [72/1000], Training Loss: 0.5508, Gradient Noise Std: 0.000028
Validation Loss: 0.5608
No improvement in validation loss. Early stop counter: 1/10
Epoch [73/1000], Training Loss: 0.5484, Gradient Noise Std: 0.000025
Validation Loss: 0.5606
No improvement in validation loss. Early stop counter: 2/10
Epoch [74/1000], Training Loss: 0.5516, Gradient Noise Std: 0.000023
Validation Loss: 0.5604
New best model found with validation loss: 0.5604
Epoch [75/1000], Training Loss: 0.5519, Gradient Noise Std: 0.000021
Validation Loss: 0.5607
No improvement in validation loss. Early stop counter: 1/10
Epoch [76/1000], Training Loss: 0.5496, Gradient Noise Std: 0.000018
Validation Loss: 0.5605
No improvement in validation loss. Early stop counter: 2/10
Epoch [77/1000], Training Loss: 0.5499, Gradient Noise Std: 0.000017
Validation Loss: 0.5606
No improvement in validation loss. Early stop counter: 3/10
Epoch [78/1000], Training Loss: 0.5504, Gradient Noise Std: 0.000015
Validation Loss: 0.5603
New best model found with validation loss: 0.5603
Epoch [79/1000], Training Loss: 0.5501, Gradient Noise Std: 0.000013
Validation Loss: 0.5604
No improvement in validation loss. Early stop counter: 1/10
Epoch [80/1000], Training Loss: 0.5503, Gradient Noise Std: 0.000012
Validation Loss: 0.5605
No improvement in validation loss. Early stop counter: 2/10
Epoch [81/1000], Training Loss: 0.5478, Gradient Noise Std: 0.000011
Validation Loss: 0.5603
New best model found with validation loss: 0.5603
Epoch [82/1000], Training Loss: 0.5498, Gradient Noise Std: 0.000010
Validation Loss: 0.5601
New best model found with validation loss: 0.5601
Epoch [83/1000], Training Loss: 0.5506, Gradient Noise Std: 0.000009
Validation Loss: 0.5602
No improvement in validation loss. Early stop counter: 1/10
Epoch [84/1000], Training Loss: 0.5498, Gradient Noise Std: 0.000008
Validation Loss: 0.5601
New best model found with validation loss: 0.5601
Epoch [85/1000], Training Loss: 0.5494, Gradient Noise Std: 0.000007
Validation Loss: 0.5600
New best model found with validation loss: 0.5600
Epoch [86/1000], Training Loss: 0.5486, Gradient Noise Std: 0.000006
Validation Loss: 0.5601
No improvement in validation loss. Early stop counter: 1/10
Epoch [87/1000], Training Loss: 0.5497, Gradient Noise Std: 0.000006
Validation Loss: 0.5600
New best model found with validation loss: 0.5600
Epoch [88/1000], Training Loss: 0.5516, Gradient Noise Std: 0.000005
Validation Loss: 0.5600
No improvement in validation loss. Early stop counter: 1/10
Epoch [89/1000], Training Loss: 0.5498, Gradient Noise Std: 0.000005
Validation Loss: 0.5600
New best model found with validation loss: 0.5600
Epoch [90/1000], Training Loss: 0.5496, Gradient Noise Std: 0.000004
Validation Loss: 0.5600
No improvement in validation loss. Early stop counter: 1/10
Epoch [91/1000], Training Loss: 0.5506, Gradient Noise Std: 0.000004
Validation Loss: 0.5600
No improvement in validation loss. Early stop counter: 2/10
Epoch [92/1000], Training Loss: 0.5492, Gradient Noise Std: 0.000003
Validation Loss: 0.5600
New best model found with validation loss: 0.5600
Epoch [93/1000], Training Loss: 0.5492, Gradient Noise Std: 0.000003
Validation Loss: 0.5599
New best model found with validation loss: 0.5599
Epoch [94/1000], Training Loss: 0.5482, Gradient Noise Std: 0.000003
Validation Loss: 0.5600
No improvement in validation loss. Early stop counter: 1/10
Epoch [95/1000], Training Loss: 0.5489, Gradient Noise Std: 0.000002
Validation Loss: 0.5600
No improvement in validation loss. Early stop counter: 2/10
Epoch [96/1000], Training Loss: 0.5492, Gradient Noise Std: 0.000002
Validation Loss: 0.5600
No improvement in validation loss. Early stop counter: 3/10
Epoch [97/1000], Training Loss: 0.5502, Gradient Noise Std: 0.000002
Validation Loss: 0.5599
New best model found with validation loss: 0.5599
Epoch [98/1000], Training Loss: 0.5480, Gradient Noise Std: 0.000002
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 1/10
Epoch [99/1000], Training Loss: 0.5477, Gradient Noise Std: 0.000002
Validation Loss: 0.5599
New best model found with validation loss: 0.5599
Epoch [100/1000], Training Loss: 0.5491, Gradient Noise Std: 0.000001
Validation Loss: 0.5599
New best model found with validation loss: 0.5599
Epoch [101/1000], Training Loss: 0.5496, Gradient Noise Std: 0.000001
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 1/10
Epoch [102/1000], Training Loss: 0.5497, Gradient Noise Std: 0.000001
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 2/10
Epoch [103/1000], Training Loss: 0.5490, Gradient Noise Std: 0.000001
Validation Loss: 0.5599
New best model found with validation loss: 0.5599
Epoch [104/1000], Training Loss: 0.5483, Gradient Noise Std: 0.000001
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 1/10
Epoch [105/1000], Training Loss: 0.5498, Gradient Noise Std: 0.000001
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 2/10
Epoch [106/1000], Training Loss: 0.5479, Gradient Noise Std: 0.000001
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 3/10
Epoch [107/1000], Training Loss: 0.5484, Gradient Noise Std: 0.000001
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 4/10
Epoch [108/1000], Training Loss: 0.5485, Gradient Noise Std: 0.000001
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 5/10
Epoch [109/1000], Training Loss: 0.5491, Gradient Noise Std: 0.000001
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 6/10
Epoch [110/1000], Training Loss: 0.5493, Gradient Noise Std: 0.000001
Validation Loss: 0.5598
New best model found with validation loss: 0.5598
Epoch [111/1000], Training Loss: 0.5485, Gradient Noise Std: 0.000000
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 1/10
Epoch [112/1000], Training Loss: 0.5492, Gradient Noise Std: 0.000000
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 2/10
Epoch [113/1000], Training Loss: 0.5490, Gradient Noise Std: 0.000000
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 3/10
Epoch [114/1000], Training Loss: 0.5486, Gradient Noise Std: 0.000000
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 4/10
Epoch [115/1000], Training Loss: 0.5489, Gradient Noise Std: 0.000000
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 5/10
Epoch [116/1000], Training Loss: 0.5492, Gradient Noise Std: 0.000000
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 6/10
Epoch [117/1000], Training Loss: 0.5490, Gradient Noise Std: 0.000000
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 7/10
Epoch [118/1000], Training Loss: 0.5497, Gradient Noise Std: 0.000000
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 8/10
Epoch [119/1000], Training Loss: 0.5487, Gradient Noise Std: 0.000000
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 9/10
Epoch [120/1000], Training Loss: 0.5491, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
New best model found with validation loss: 0.5598
Epoch [121/1000], Training Loss: 0.5485, Gradient Noise Std: 0.000000
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 1/10
Epoch [122/1000], Training Loss: 0.5481, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
New best model found with validation loss: 0.5598
Epoch [123/1000], Training Loss: 0.5488, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
New best model found with validation loss: 0.5598
Epoch [124/1000], Training Loss: 0.5496, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
No improvement in validation loss. Early stop counter: 1/10
Epoch [125/1000], Training Loss: 0.5494, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
No improvement in validation loss. Early stop counter: 2/10
Epoch [126/1000], Training Loss: 0.5490, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
No improvement in validation loss. Early stop counter: 3/10
Epoch [127/1000], Training Loss: 0.5502, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
No improvement in validation loss. Early stop counter: 4/10
Epoch [128/1000], Training Loss: 0.5483, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
New best model found with validation loss: 0.5598
Epoch [129/1000], Training Loss: 0.5493, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
New best model found with validation loss: 0.5598
Epoch [130/1000], Training Loss: 0.5486, Gradient Noise Std: 0.000000
Validation Loss: 0.5599
No improvement in validation loss. Early stop counter: 1/10
Epoch [131/1000], Training Loss: 0.5490, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
No improvement in validation loss. Early stop counter: 2/10
Epoch [132/1000], Training Loss: 0.5497, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
No improvement in validation loss. Early stop counter: 3/10
Epoch [133/1000], Training Loss: 0.5487, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
No improvement in validation loss. Early stop counter: 4/10
Epoch [134/1000], Training Loss: 0.5494, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
No improvement in validation loss. Early stop counter: 5/10
Epoch [135/1000], Training Loss: 0.5494, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
No improvement in validation loss. Early stop counter: 6/10
Epoch [136/1000], Training Loss: 0.5492, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
No improvement in validation loss. Early stop counter: 7/10
Epoch [137/1000], Training Loss: 0.5481, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
No improvement in validation loss. Early stop counter: 8/10
Epoch [138/1000], Training Loss: 0.5488, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
No improvement in validation loss. Early stop counter: 9/10
Epoch [139/1000], Training Loss: 0.5481, Gradient Noise Std: 0.000000
Validation Loss: 0.5598
No improvement in validation loss. Early stop counter: 10/10
Early stopping triggered after 139 epochs.
Best model saved successfully.
