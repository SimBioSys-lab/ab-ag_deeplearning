{'batch_size': 16, 'sequence_file': 'preprocessed_seq_ab_train_1200.npz', 'pt_file': 'pt_train_data.csv', 'sasa_file': 'sasa_train_data.csv', 'ss_file': 'ss_train_data.csv', 'seq_len': 1200, 'vocab_size': 22, 'embed_dim': 128, 'num_heads': 8, 'num_layers': 3, 'num_classes_pt': 2, 'num_classes_ss': 8, 'num_epochs': 200, 'learning_rate': 0.003, 'n_splits': 5, 'max_grad_norm': 0.5, 'early_stop_patience': 20}
Number of GPUs available: 4
Initializing UnifiedModel with 3 unique self-attention layers...
Using 4 GPUs with DataParallel.
Starting fold 1/5
Fold 1, Epoch [1/200], Training Loss: 2217688.2381, PT Loss: 474.2379
Fold 1, Epoch [1/200], Validation Loss: 279.8148
New best model found at fold 1, epoch 1 with validation loss: 279.8148
Fold 1, Epoch [2/200], Training Loss: 863.7923, PT Loss: 178.7833
Fold 1, Epoch [2/200], Validation Loss: 860.5460
No improvement in validation loss. Early stop counter: 1/20
Fold 1, Epoch [3/200], Training Loss: 450.8387, PT Loss: 114.1250
Fold 1, Epoch [3/200], Validation Loss: 622.4682
No improvement in validation loss. Early stop counter: 2/20
Fold 1, Epoch [4/200], Training Loss: 2304.9865, PT Loss: 416.9798
Fold 1, Epoch [4/200], Validation Loss: 2961.1622
No improvement in validation loss. Early stop counter: 3/20
Fold 1, Epoch [5/200], Training Loss: 1327.9896, PT Loss: 454.1454
Fold 1, Epoch [5/200], Validation Loss: 2113.5411
No improvement in validation loss. Early stop counter: 4/20
Fold 1, Epoch [6/200], Training Loss: 1627.8776, PT Loss: 321.4122
Fold 1, Epoch [6/200], Validation Loss: 1780.5009
No improvement in validation loss. Early stop counter: 5/20
Fold 1, Epoch [7/200], Training Loss: 917.0027, PT Loss: 343.0419
Fold 1, Epoch [7/200], Validation Loss: 839.1044
No improvement in validation loss. Early stop counter: 6/20
Fold 1, Epoch [8/200], Training Loss: 843.3152, PT Loss: 409.5458
Fold 1, Epoch [8/200], Validation Loss: 1056.0222
No improvement in validation loss. Early stop counter: 7/20
Fold 1, Epoch [9/200], Training Loss: 3874.3361, PT Loss: 256.8032
Fold 1, Epoch [9/200], Validation Loss: 2216.6603
No improvement in validation loss. Early stop counter: 8/20
Fold 1, Epoch [10/200], Training Loss: 2056.1739, PT Loss: 746.3071
Fold 1, Epoch [10/200], Validation Loss: 2296.8047
No improvement in validation loss. Early stop counter: 9/20
Fold 1, Epoch [11/200], Training Loss: 1649.7652, PT Loss: 756.8985
Fold 1, Epoch [11/200], Validation Loss: 2606.2625
No improvement in validation loss. Early stop counter: 10/20
Fold 1, Epoch [12/200], Training Loss: 1379.0088, PT Loss: 639.1186
Fold 1, Epoch [12/200], Validation Loss: 2055.8674
No improvement in validation loss. Early stop counter: 11/20
Fold 1, Epoch [13/200], Training Loss: inf, PT Loss: 513.3337
Fold 1, Epoch [13/200], Validation Loss: inf
No improvement in validation loss. Early stop counter: 12/20
Fold 1, Epoch [14/200], Training Loss: inf, PT Loss: 826.8970
Fold 1, Epoch [14/200], Validation Loss: 2490.9461
No improvement in validation loss. Early stop counter: 13/20
Fold 1, Epoch [15/200], Training Loss: 1568.1063, PT Loss: 681.4164
Fold 1, Epoch [15/200], Validation Loss: 2893.3332
No improvement in validation loss. Early stop counter: 14/20
Fold 1, Epoch [16/200], Training Loss: 1137.0705, PT Loss: 380.8440
Fold 1, Epoch [16/200], Validation Loss: 1100.4948
No improvement in validation loss. Early stop counter: 15/20
Fold 1, Epoch [17/200], Training Loss: 1017.8149, PT Loss: 447.0338
Fold 1, Epoch [17/200], Validation Loss: 1260.0118
No improvement in validation loss. Early stop counter: 16/20
Fold 1, Epoch [18/200], Training Loss: 31446.7349, PT Loss: 1027.8470
Fold 1, Epoch [18/200], Validation Loss: 1553.0552
No improvement in validation loss. Early stop counter: 17/20
Fold 1, Epoch [19/200], Training Loss: 1709.9388, PT Loss: 417.1163
Fold 1, Epoch [19/200], Validation Loss: 2399.9753
No improvement in validation loss. Early stop counter: 18/20
Fold 1, Epoch [20/200], Training Loss: 1493.9723, PT Loss: 631.0157
Fold 1, Epoch [20/200], Validation Loss: 2577.3503
No improvement in validation loss. Early stop counter: 19/20
Fold 1, Epoch [21/200], Training Loss: 1809.8005, PT Loss: 528.7514
Fold 1, Epoch [21/200], Validation Loss: 3728.1104
No improvement in validation loss. Early stop counter: 20/20
Early stopping triggered after epoch 21 in fold 1.
Starting fold 2/5
Fold 2, Epoch [1/200], Training Loss: 1243.1849, PT Loss: 453.5063
Fold 2, Epoch [1/200], Validation Loss: 2362.1882
No improvement in validation loss. Early stop counter: 21/20
Early stopping triggered after epoch 1 in fold 2.
Starting fold 3/5
Fold 3, Epoch [1/200], Training Loss: nan, PT Loss: nan
Fold 3, Epoch [1/200], Validation Loss: nan
No improvement in validation loss. Early stop counter: 22/20
Early stopping triggered after epoch 1 in fold 3.
Starting fold 4/5
Fold 4, Epoch [1/200], Training Loss: nan, PT Loss: nan
Fold 4, Epoch [1/200], Validation Loss: nan
No improvement in validation loss. Early stop counter: 23/20
Early stopping triggered after epoch 1 in fold 4.
Starting fold 5/5
Fold 5, Epoch [1/200], Training Loss: nan, PT Loss: nan
Fold 5, Epoch [1/200], Validation Loss: nan
No improvement in validation loss. Early stop counter: 24/20
Early stopping triggered after epoch 1 in fold 5.
Average Validation Loss across 5 folds: 279.8148
Best model saved successfully.
